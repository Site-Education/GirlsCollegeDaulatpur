<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ONLINE QUIZ</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>
    <style>
      body {
        font-size: 1rem;
        line-height: 1.5;
        background: linear-gradient(
          to top right,
          #80cbc4,
          #e1bee7,
          #80ddea,
          #d1c4e9
        );
        text-align: center;
        margin: 0;
        padding: 0;
      }
      .navbar {
        padding: 1rem;
      }
      .container {
        width: 60%;
        margin: 0 auto;
        background-color: #fae8e4;
        padding: 0.4em;
        border-radius: 0.5em;
        box-shadow: 0 0.2em 0.5em rgba(0, 0, 0, 0.1);
      }
      #chapter-title {
        margin-top: 0.1em;
        margin-bottom: 0.1em;
        font-size: 1.25rem;
      }
      h2 {
        color: #4caf50;
        font-size: 1.25rem;
        margin: 0;
      }
      h1 {
        color: #4caf50;
        font-size: 1.5rem;
        margin: 0.1em;
      }
      .btn {
        padding: 0.5em 1.5em;
        font-size: 1rem;
        margin: 0.2em;
        border-radius: 0.5em;
        cursor: pointer;
        border: none;
        transition: background-color 0.2s;
      }
      .start-btn {
        background-color: #4caf50;
        color: white;
      }
      .next-btn,
      .prev-btn {
        background-color: #ff5722;
        color: white;
      }
      .close-btn {
        background-color: #f44336;
        color: white;
      }
      .back-btn {
        background-color: #2196f3;
        color: white;
      }
      .timer {
        font-size: 1.3rem;
        margin-bottom: 0.1em;
        color: #ff5722;
      }
      .question {
        font-size: 1.1rem;
        margin: 0em 1em 1em 1em;
        padding: 0.1em;
        line-height: 1.3;
      }
      .options {
        margin: 0.5em 0;
      }
      .options label {
        display: block;
        margin: 0.5em 0;
        padding: 0.5em;
        border-radius: 0.5em;
        cursor: pointer;
      }
      .question-number {
        font-size: 1.3rem;
        color: #2196f3;
        margin: 0;
      }
      .question-navigation {
        margin-top: 0.5em;
      }
      .section {
        display: none;
      }
      .detailed-explanation {
        margin: 0;
        padding: 0.8em;
        background-color: #f1f1f1;
        border-radius: 0.4em;
        font-size: 1rem;
      }
      .score-container {
        font-size: 1.2rem;
        color: #4caf50;
        margin-top: 1.5em;
      }
      .score-container span {
        font-weight: bold;
      }
      .correct-option {
        background-color: #4caf50;
        color: white;
      }
      .incorrect-option {
        background-color: #f44336;
        color: white;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="nav-link text-white active" href="../index.html">HOME</a>
      <a class="nav-link text-white" href="./onlineTest.html">ONLINE TEST</a>
      <a class="nav-link text-white" href="./TEST-PDF.html">TEST PDF</a>
      <a class="nav-link text-white" href="./CONTACT.html">CONTACT</a>
      <a class="nav-link text-white" href="./ABOUT.html">ABOUT</a>
      <a class="navbar-brand text-white" href="./ChemistryWithMe.html"
        >ChemistryWithMe</a
      >
    </nav>

    <div class="container">
      <h2 style="color: Blue">*WISH YOU BEST OF LUCK*</h2>
      <div id="subject-selection" class="section">
        <h1>Select a Subject</h1>
        <button class="btn start-btn" onclick="selectChapter(1)">
          9th: Chemistry
        </button>
        <button class="btn start-btn" onclick="selectChapter(2)">
          10th: Chemistry
        </button>
        <h2 style="text-align: center; color: blue; font-size: 18px">
          Dear students: More MCQs will be provided to you as soon as possible
        </h2>
      </div>

      <div id="chapter-selection" class="section">
        <h1>Select a Chapter</h1>
        <div id="chapter-buttons"></div>
        <button class="btn back-btn" onclick="goBackToSubject()">
          Back to Subject
        </button>
      </div>

      <div id="question-number-selection" class="section">
        <h1>Total Questions</h1>
        <button class="btn start-btn" onclick="startQuiz(25)">
          25 Questions
        </button>
      </div>

      <div id="quiz-container" class="section">
        <h2 id="quiz-title"></h2>
        <h3 id="chapter-title"></h3>
        <div class="timer">
          Time Remaining: <span id="timer">300</span> seconds
        </div>
        <div class="question-number">
          Question <span id="current-question-number">1</span> of
          <span id="total-questions"></span>
        </div>
        <div class="question" id="question-container"></div>
        <div class="options" id="options-container"></div>
        <button class="btn" id="explanation-btn" onclick="toggleExplanation()">
          Show Explanation
        </button>
        <div
          id="detailed-explanation"
          class="detailed-explanation"
          style="display: none"
        ></div>
        <div class="question-navigation">
          <button
            class="btn prev-btn"
            id="prev-btn"
            onclick="goToPreviousQuestion()"
            disabled
          >
            Previous Question
          </button>
          <button
            class="btn next-btn"
            id="next-btn"
            onclick="goToNextQuestion()"
            disabled
          >
            Next Question
          </button>
        </div>
        <button class="btn close-btn" onclick="closeQuestion()">
          Close Question
        </button>
        <button class="btn back-btn" onclick="goBackToSubject()">
          Back to Subject
        </button>
      </div>

      <div id="score-container" class="section">
        <h2>Your Score: <span id="score"></span></h2>
        <button class="btn back-btn" onclick="goBackToSubject()">
          Back to Select a Subject
        </button>
      </div>
    </div>

    <script>
      let currentSubject = null;
      let currentChapter = 0;
      let currentQuestionIndex = 0;
      let score = 0;
      let timer = 300;
      let totalQuestions = 0;
      let answeredQuestions = [];
      let timerInterval = null;

      let quizData = {
        1: {
          title: "9: Chemistry - Test Preparation",
          chapters: [
            {
              title: "Chapter 1: Fractions",
              questions: [
                {
                  question: "Which of the following represents a fraction?",
                  options: [
                    "A. <span>\\( \\frac{n}{d} \\)</span>",
                    "B. <span>\\( \\dfrac{n}{d} \\)</span>", // Correct answer
                    "C. <span>\\( \\tfrac{n}{d} \\)</span>",
                    "D. None of the above",
                  ],
                  correct: "B",
                  explanation:
                    "Option B uses the \\( \\dfrac \\) command, which renders the fraction in display-style math for a more prominent fraction.",
                },
                {
                  question: "What is the equation for a fraction?",
                  options: [
                    "A. <span>\\( z = \\frac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>",
                    "B. <span>\\( z = \\dfrac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>", // Correct answer
                    "C. <span>\\( z = \\tfrac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>",
                    "D. <span>\\( \\int_{0}^{1} x^2 \, dx \\)</span>",
                  ],
                  correct: "B",
                  explanation:
                    "Option B uses the \\( \\dfrac \\) command, which is a larger fraction suitable for display-style math.",
                },
                {
                  question: "Antiprotozoal drug is also known as ________?",
                  options: [
                    "Anti-allergic",
                    "Antibiotic",
                    "Antimalarial",
                    "Antivirus",
                  ], // Correct answer: Antimalarial
                  correct: "Antimalarial",
                  explanation:
                    "Antiprotozoal drugs are used to treat infections caused by protozoa, such as malaria.",
                },
                {
                  question: "Antiprotozoal drug is also known as ________?",
                  options: [
                    "Anti-allergic",
                    "Antibiotic",
                    "Antimalarial",
                    "Antivirus",
                  ], // Correct answer: Antimalarial
                  correct: "Antimalarial",
                  explanation:
                    "Antiprotozoal drugs are used to treat infections caused by protozoa, such as malaria.",
                },
                {
                  question: "What is the equation for a fraction?",
                  options: [
                    "A. <span>\\( z = \\frac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>",
                    "B. <span>\\( z = \\dfrac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>", // Correct answer
                    "C. <span>\\( z = \\tfrac{\\sum_{i=1}^N{x_i}}{\\sum_{i=1}^N{y_i}} \\)</span>",
                    "D. <span>\\( \\int_{0}^{1} x^2 \, dx \\)</span>",
                  ],
                  correct: "B",
                  explanation:
                    "Option B uses the \\( \\dfrac \\) command, which is a larger fraction suitable for display-style math.",
                },
              ],
            },
          ],
        },
      };

      function showSubjectSelection() {
        document.getElementById("subject-selection").style.display = "block";
        document.getElementById("chapter-selection").style.display = "none";
        document.getElementById("question-number-selection").style.display =
          "none";
        document.getElementById("quiz-container").style.display = "none";
        document.getElementById("score-container").style.display = "none";
      }

      function selectChapter(subject) {
        currentSubject = subject;
        let chapterButtons = quizData[subject].chapters
          .map((chapter, index) => {
            return `<button class="btn start-btn" onclick="selectChapterAndLoadQuestions(${subject}, ${index})">${chapter.title}</button>`;
          })
          .join("");
        document.getElementById("chapter-buttons").innerHTML = chapterButtons;
        document.getElementById("subject-selection").style.display = "none";
        document.getElementById("chapter-selection").style.display = "block";
      }

      function selectChapterAndLoadQuestions(subject, chapterIndex) {
        currentChapter = chapterIndex;
        let chapter = quizData[subject].chapters[chapterIndex];
        let questionCount = chapter.questions.length;

        document.getElementById(
          "chapter-title"
        ).innerText = `Chapter: ${chapter.title}`;

        document.getElementById("question-number-selection").style.display =
          "block";
        document.getElementById("chapter-selection").style.display = "none";
      }

      function startQuiz(numberOfQuestions) {
        score = 0;
        currentQuestionIndex = 0;
        totalQuestions = numberOfQuestions;
        answeredQuestions = [];
        loadQuestion();
        timer = 300;
        document.getElementById("timer").innerText = timer;
        startTimer();

        document.getElementById("question-number-selection").style.display =
          "none";
        document.getElementById("quiz-container").style.display = "block";
        document.getElementById("quiz-title").innerText =
          quizData[currentSubject].title;
      }

      function startTimer() {
        timerInterval = setInterval(() => {
          if (timer > 0) {
            timer--;
            document.getElementById("timer").innerText = timer;
          } else {
            clearInterval(timerInterval);
            showScore();
          }
        }, 1000);
      }

      function loadQuestion() {
        let currentChapterData =
          quizData[currentSubject].chapters[currentChapter];
        let questionData = currentChapterData.questions[currentQuestionIndex];

        document.getElementById("question-container").innerHTML =
          questionData.question;
        document.getElementById("options-container").innerHTML =
          questionData.options
            .map((option, index) => {
              return `<label><input type="radio" name="option" value="${option}" onclick="selectOption('${option}')"> ${option}</label><br>`;
            })
            .join("");

        MathJax.Hub.Queue(["Typeset", MathJax.Hub]);

        document.getElementById("current-question-number").innerText =
          currentQuestionIndex + 1;
        document.getElementById("total-questions").innerText = totalQuestions;

        document.getElementById("detailed-explanation").style.display = "none";
        document.getElementById("prev-btn").disabled =
          currentQuestionIndex === 0;
        document.getElementById("next-btn").disabled =
          currentQuestionIndex === totalQuestions - 1;
      }

      function selectOption(option) {
        if (answeredQuestions.includes(currentQuestionIndex)) return;

        let currentChapterData =
          quizData[currentSubject].chapters[currentChapter];
        let questionData = currentChapterData.questions[currentQuestionIndex];

        document.querySelectorAll(".options label").forEach((label) => {
          if (label.textContent.includes(option)) {
            label.classList.add(
              option.includes(questionData.correct)
                ? "correct-option"
                : "incorrect-option"
            );
          }
          if (label.textContent.includes(questionData.correct)) {
            label.classList.add("correct-option");
          }
        });

        if (option.includes(questionData.correct)) {
          score++;
        }

        answeredQuestions.push(currentQuestionIndex);
        document.getElementById("next-btn").disabled = false;
      }

      function goToNextQuestion() {
        if (currentQuestionIndex < totalQuestions - 1) {
          currentQuestionIndex++;
          loadQuestion();
        }
      }

      function goToPreviousQuestion() {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          loadQuestion();
        }
      }

      function showScore() {
        document.getElementById("quiz-container").style.display = "none";
        document.getElementById("score-container").style.display = "block";
        document.getElementById(
          "score"
        ).innerText = `${score} / ${totalQuestions}`;
      }

      function closeQuestion() {
        clearInterval(timerInterval);
        showScore();
      }

      function goBackToSubject() {
        clearInterval(timerInterval);
        showSubjectSelection();
      }

      function toggleExplanation() {
        let currentChapterData =
          quizData[currentSubject].chapters[currentChapter];
        let questionData = currentChapterData.questions[currentQuestionIndex];
        let explanationDiv = document.getElementById("detailed-explanation");
        if (questionData.explanation) {
          if (explanationDiv.style.display === "none") {
            explanationDiv.style.display = "block";
            explanationDiv.innerText = questionData.explanation;
          } else {
            explanationDiv.style.display = "none";
          }
        }
      }

      showSubjectSelection(); // Initial screen to show subject selection
    </script>
  </body>
</html>
